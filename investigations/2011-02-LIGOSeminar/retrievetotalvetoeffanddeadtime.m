
clear 

rootDir = '/archive/home/detchar/public_html/S6/BCV/weekly';

subDirVec = {...
   'H1_DARMERR_934675200_935798487_WEEKLY_webpage',...
   'H1_DARMERR_937800015_938822415_WEEKLY_webpage',...
   'H1_DARMERR_938822415_940032015_WEEKLY_webpage',...
   'H1_DARMERR_940032015_941241615_WEEKLY_webpage',...
   'H1_DARMERR_941241615_942451215_WEEKLY_webpage',...
   'H1_DARMERR_942451215_943660815_WEEKLY_webpage',...
   'H1_DARMERR_943660815_944870415_WEEKLY_webpage',...
   'H1_DARMERR_944870415_946080015_WEEKLY_webpage',...
   'H1_DARMERR_946080015_947260815_WEEKLY_webpage',...
   'H1_DARMERR_963360015_963964815_WEEKLY_webpage',...
   'L1_DARMERR_934675200_935798487_WEEKLY_webpage',...
   'L1_DARMERR_937800015_938822415_WEEKLY_webpage',...
   'L1_DARMERR_938822415_940032015_WEEKLY_webpage',...
   'L1_DARMERR_940032015_940636815_WEEKLY_webpage',...
   'L1_DARMERR_940636815_941241615_WEEKLY_webpage',...
   'L1_DARMERR_941241615_941846415_WEEKLY_webpage',...
   'L1_DARMERR_941846415_942451215_WEEKLY_webpage',...
   'L1_DARMERR_942451215_943056015_WEEKLY_webpage',...
   'L1_DARMERR_943056015_943660815_WEEKLY_webpage',...
   'L1_DARMERR_943660815_944265615_WEEKLY_webpage',...
   'L1_DARMERR_944265615_944870415_WEEKLY_webpage',...
   'L1_DARMERR_944870415_945475215_WEEKLY_webpage',...
   'L1_DARMERR_945475215_946080015_WEEKLY_webpage',...
   'L1_DARMERR_946080015_946684815_WEEKLY_webpage',...
   'L1_DARMERR_946684815_947289615_WEEKLY_webpage',...
   'L1_DARMERR_971222415_971827215_WEEKLY_webpage'};

for iSubDir = 1:length(subDirVec);

	subDir = subDirVec{iSubDir};
	ifo = subDir(1:2);
	[status, html_parsed] = system(['cat ' rootDir '/' subDir  '/index.html | grep "Total Veto Efficiency"']);

	i = findstr(subDir, '_');
	startTime = str2num(subDir(i(2)+1:i(3)-1));
	endTime = str2num(subDir(i(3)+1:i(4)-1));

	outFileName = [ifo '_VetoEffDeadTimeSummary.txt'];

	if status == 0 

		% get veto efficiency 
		searchStr = 'Total Veto Efficiency:';
		i = strfind(html_parsed, searchStr);
		j = strfind(html_parsed, '%'); 
		vetoEff = str2num(html_parsed(i+length(searchStr) +1:j(1)-1));
	
        % get the total H triggers 
        i = strfind(html_parsed, '(');
        j = strfind(html_parsed, ')');
        hTrigStr = html_parsed(i(1)+1:j(1)-1);
        i = strfind(hTrigStr, '/');
        numHTrig = str2num(hTrigStr(i+1:end));

		% get dead tune 
		searchStr = 'Total Dead Time:';
		i = strfind(html_parsed, searchStr);
		j = strfind(html_parsed, '%'); 
		deadTimeStr = html_parsed(i+length(searchStr) +1:j(2)-1);
		i = strfind(deadTimeStr, '('); 
		deadTime = str2num(deadTimeStr(i+1:end));

        fp = fopen(outFileName, 'a');
        fprintf(fp, '%d \t %d \t %3.2f \t %3.2f \t %d\n', startTime, endTime, vetoEff, deadTime, numHTrig);
        fprintf('%d \t %d \t %3.2f \t %3.2f \t %d\n', startTime, endTime, vetoEff, deadTime, numHTrig);
        fclose(fp);

	else 
		fprintf('... index.html not found\n');
	end 

end
